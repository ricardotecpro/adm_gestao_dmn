============================= test session starts =============================
platform win32 -- Python 3.13.0, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\rlp\AppData\Local\pypoetry\Cache\virtualenvs\adm-gestao-dmn-3KhNbOwh-py3.13\Scripts\python.exe
cachedir: .pytest_cache
baseurl: http://127.0.0.1:8766
rootdir: D:\SourceCode\REPOS\github.io\adm_gestao_dmn
configfile: pyproject.toml
plugins: base-url-2.1.0, playwright-0.5.2
collecting ... collected 6 items

tests/test_fullscreen.py::test_shortcuts_hidden_in_fullscreen[chromium] FAILED [ 16%]
tests/test_navigation.py::TestNavigation::test_home_page_loads[chromium] PASSED [ 33%]
tests/test_navigation.py::TestNavigation::test_curso_menu_exists[chromium] PASSED [ 50%]
tests/test_navigation.py::TestNavigation::test_plano_ensino_menu_exists[chromium] PASSED [ 66%]
tests/test_navigation.py::TestNavigation::test_print_version_link_exists[chromium] PASSED [ 83%]
tests/test_navigation.py::TestNavigation::test_navigation_to_lesson_01[chromium] PASSED [100%]

================================== FAILURES ===================================
________________ test_shortcuts_hidden_in_fullscreen[chromium] ________________

page = <Page url='http://127.0.0.1:8766/slides/slide-01.html'>

    def test_shortcuts_hidden_in_fullscreen(page: Page):
        """
        Test that the .reveal-shortcuts element is hidden when the presentation
        enters fullscreen mode.
    
        Note: Fullscreen API in headless mode can be tricky.
        We rely on checking if the CSS pseudo-class matches or if specific styling is applied.
        However, forcing pseudo-classes in Playwright is hard.
        Instead, we check if the element has the class or if we can simulate the state.
    
        Actually, triggering 'F' in Reveal.js triggers the API.
        Browsers usually require user gesture. page.keyboard.press helps.
        """
        # Load a slide
        page.on("console", lambda msg: print(f"BROWSER LOG: {msg.text}"))
        page.goto("/slides/slide-01.html")
    
    
        # 1. Verify shortcuts are initially visible
        shortcuts = page.locator(".reveal-shortcuts")
        print(f"\nCreated locator. Count: {shortcuts.count()}")
    
        # Debug info
        if shortcuts.count() > 0:
            box = shortcuts.bounding_box()
            print(f"Bounding box: {box}")
            viz = shortcuts.is_visible()
            print(f"Is visible: {viz}")
            if not viz:
                # Check style
                display = shortcuts.evaluate("el => getComputedStyle(el).display")
                print(f"Computed display: {display}")
                opacity = shortcuts.evaluate("el => getComputedStyle(el).opacity")
                print(f"Computed opacity: {opacity}")
    
        expect(shortcuts).to_be_visible()
        print("Step 1: Initially visible - PASSED")
    
        # 2. Simulate Fullscreen Event
        page.evaluate("""
            Object.defineProperty(document, 'fullscreenElement', {
              get: () => document.documentElement,
              configurable: true
            });
            document.dispatchEvent(new Event('fullscreenchange'));
        """)
    
        # 3. Verify shortcuts are hidden
        # Wait for JS to run
        page.wait_for_timeout(500)
    
        # Debug info
        viz = shortcuts.is_visible()
        print(f"Step 3 Is visible: {viz}")
        if viz:
            display = shortcuts.evaluate("el => el.style.display")
            print(f"Step 3 Inline display: {display}")
    
>       expect(shortcuts).not_to_be_visible()
E       AssertionError: Locator expected not to be visible
E       Actual value: visible 
E       Call log:
E         - Expect "to_be_visible" with timeout 5000ms
E         - waiting for locator(".reveal-shortcuts")
E           9 � locator resolved to <div class="reveal-shortcuts">�</div>
E             - unexpected value "visible"

tests\test_fullscreen.py:62: AssertionError
---------------------------- Captured stdout call -----------------------------
BROWSER LOG: BROWSER LOG: FS Change triggered: false

Created locator. Count: 1
Bounding box: {'x': 453.1640625, 'y': 678, 'width': 373.671875, 'height': 22}
Is visible: True
Step 1: Initially visible - PASSED
BROWSER LOG: BROWSER LOG: FS Change triggered: true
Step 3 Is visible: True
Step 3 Inline display: 
=========================== short test summary info ===========================
FAILED tests/test_fullscreen.py::test_shortcuts_hidden_in_fullscreen[chromium]
======================== 1 failed, 5 passed in 22.87s =========================
