============================= test session starts =============================
platform win32 -- Python 3.13.0, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\rlp\AppData\Local\pypoetry\Cache\virtualenvs\adm-gestao-dmn-3KhNbOwh-py3.13\Scripts\python.exe
cachedir: .pytest_cache
baseurl: http://127.0.0.1:8766
rootdir: D:\SourceCode\REPOS\github.io\adm_gestao_dmn
configfile: pyproject.toml
plugins: base-url-2.1.0, playwright-0.5.2
collecting ... collected 6 items

tests/test_fullscreen.py::test_shortcuts_hidden_in_fullscreen[chromium] FAILED [ 16%]
tests/test_navigation.py::TestNavigation::test_home_page_loads[chromium] PASSED [ 33%]
tests/test_navigation.py::TestNavigation::test_curso_menu_exists[chromium] PASSED [ 50%]
tests/test_navigation.py::TestNavigation::test_plano_ensino_menu_exists[chromium] PASSED [ 66%]
tests/test_navigation.py::TestNavigation::test_print_version_link_exists[chromium] PASSED [ 83%]
tests/test_navigation.py::TestNavigation::test_navigation_to_lesson_01[chromium] FAILED [100%]

================================== FAILURES ===================================
________________ test_shortcuts_hidden_in_fullscreen[chromium] ________________

page = <Page url='http://127.0.0.1:8766/slides/slide-01.html'>

    def test_shortcuts_hidden_in_fullscreen(page: Page):
        """
        Test that the .reveal-shortcuts element is hidden when the presentation
        enters fullscreen mode.
    
        Note: Fullscreen API in headless mode can be tricky.
        We rely on checking if the CSS pseudo-class matches or if specific styling is applied.
        However, forcing pseudo-classes in Playwright is hard.
        Instead, we check if the element has the class or if we can simulate the state.
    
        Actually, triggering 'F' in Reveal.js triggers the API.
        Browsers usually require user gesture. page.keyboard.press helps.
        """
        # Load a slide
        page.on("console", lambda msg: print(f"BROWSER LOG: {msg.text}"))
        page.goto("/slides/slide-01.html")
    
    
        # 1. Verify shortcuts are initially visible
        shortcuts = page.locator(".reveal-shortcuts")
        print(f"\nCreated locator. Count: {shortcuts.count()}")
    
        # Debug info
        if shortcuts.count() > 0:
            box = shortcuts.bounding_box()
            print(f"Bounding box: {box}")
            viz = shortcuts.is_visible()
            print(f"Is visible: {viz}")
            if not viz:
                # Check style
                display = shortcuts.evaluate("el => getComputedStyle(el).display")
                print(f"Computed display: {display}")
                opacity = shortcuts.evaluate("el => getComputedStyle(el).opacity")
                print(f"Computed opacity: {opacity}")
    
        expect(shortcuts).to_be_visible()
        print("Step 1: Initially visible - PASSED")
    
        # 2. Simulate Fullscreen Event
        page.evaluate("""
            Object.defineProperty(document, 'fullscreenElement', {
              get: () => document.documentElement,
              configurable: true
            });
            document.dispatchEvent(new Event('fullscreenchange'));
        """)
    
        # 3. Verify shortcuts are hidden
        # Wait for JS to run
        page.wait_for_timeout(500)
    
        # Debug info
        viz = shortcuts.is_visible()
        print(f"Step 3 Is visible: {viz}")
        if viz:
            display = shortcuts.evaluate("el => el.style.display")
            print(f"Step 3 Inline display: {display}")
    
>       expect(shortcuts).not_to_be_visible()
E       AssertionError: Locator expected not to be visible
E       Actual value: visible 
E       Call log:
E         - Expect "to_be_visible" with timeout 5000ms
E         - waiting for locator(".reveal-shortcuts")
E           9 � locator resolved to <div class="reveal-shortcuts">�</div>
E             - unexpected value "visible"

tests\test_fullscreen.py:62: AssertionError
---------------------------- Captured stdout call -----------------------------
BROWSER LOG: BROWSER LOG: FS Change triggered: false

Created locator. Count: 1
Bounding box: {'x': 478.140625, 'y': 686, 'width': 323.71875, 'height': 24}
Is visible: True
Step 1: Initially visible - PASSED
BROWSER LOG: BROWSER LOG: FS Change triggered: true
Step 3 Is visible: True
Step 3 Inline display: 
____________ TestNavigation.test_navigation_to_lesson_01[chromium] ____________

self = <test_navigation.TestNavigation object at 0x000001FE94954950>
page_with_base_url = <Page url='http://127.0.0.1:8766/aulas/aula-01/'>
base_url = 'http://127.0.0.1:8766'

    def test_navigation_to_lesson_01(self, page_with_base_url: Page, base_url: str):
        """Verifica se � poss�vel navegar para Aula 01"""
        page = page_with_base_url
        page.goto(base_url)
    
        self._ensure_menu_visible(page)
    
        # Navigate Aulas -> M�dulo 1: Fundamentos -> Aula 01
        # Click Aulas
        page.get_by_role("link", name="Aulas").first.click(force=True)
    
        # Click M�dulo 1 - Fundamentos e Oportunidade
        # Use a more robust locator targeting the label specifically
        module_label = page.locator("label:has-text('M�dulo 1 - Fundamentos e Oportunidade')").first
        module_label.click(force=True)
    
        # Short wait for menu expansion animation
        page.wait_for_timeout(500)
    
        # Click Aula 01
        aula_01_link = page.get_by_role("link", name="Aula 01", exact=False).first
        expect(aula_01_link).to_be_visible()
        aula_01_link.click(force=True)
    
        # Verifica se chegou na p�gina correta
        expect(page).to_have_url(re.compile(r".*/aulas/aula-01/?$"))
        # H1 is "Aula 01 - Intro ao Empreendedorismo..."
>       expect(page.locator("h1")).to_contain_text("Intro ao Empreendedorismo")
E       AssertionError: Locator expected to contain text 'Intro ao Empreendedorismo'
E       Actual value: Aula 01 - Conceitos de Empreendedorismo e Vis\xe3o Empreendedora \U0001f680 
E       Call log:
E         - Expect "to_contain_text" with timeout 5000ms
E         - waiting for locator("h1")
E           8 � locator resolved to <h1 id="aula-01-conceitos-de-empreendedorismo-e-visao-empreendedora">Aula 01 - Conceitos de Empreendedorismo e Vis�o E�</h1>
E             - unexpected value "Aula 01 - Conceitos de Empreendedorismo e Vis\xe3o Empreendedora \U0001f680"

tests\test_navigation.py:87: AssertionError
=========================== short test summary info ===========================
FAILED tests/test_fullscreen.py::test_shortcuts_hidden_in_fullscreen[chromium]
FAILED tests/test_navigation.py::TestNavigation::test_navigation_to_lesson_01[chromium]
======================== 2 failed, 4 passed in 26.77s =========================
