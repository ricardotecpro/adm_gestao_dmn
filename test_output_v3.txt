============================= test session starts =============================
platform win32 -- Python 3.13.0, pytest-9.0.1, pluggy-1.6.0 -- C:\Python\Python313\python.exe
cachedir: .pytest_cache
baseurl: http://127.0.0.1:8766
rootdir: D:\SourceCode\REPOS\github.io\adm_gestao_dmn
configfile: pyproject.toml
plugins: anyio-4.11.0, base-url-2.1.0, cov-7.0.0, mock-3.15.1, playwright-0.7.2
collecting ... collected 3 items

tests/test_navigation.py::TestNavigation::test_home_page_loads[chromium] PASSED [ 33%]
tests/test_navigation.py::TestNavigation::test_navigation_menus_exist[chromium] PASSED [ 66%]
tests/test_navigation.py::TestNavigation::test_navigation_to_first_lesson[chromium] FAILED [100%]

================================== FAILURES ===================================
__________ TestNavigation.test_navigation_to_first_lesson[chromium] ___________

self = <test_navigation.TestNavigation object at 0x000001A5CE2F4D60>
page_with_base_url = <Page url='http://127.0.0.1:8766/aulas/'>
base_url = 'http://127.0.0.1:8766'

    def test_navigation_to_first_lesson(self, page_with_base_url: Page, base_url: str):
        """Dinamicamente navega para a primeira aula encontrada no nav"""
        page = page_with_base_url
        page.goto(base_url)
        self._ensure_menu_visible(page)
    
        # Buscar seþÒo de Aulas ou similar (geralmente o segundo item ou o que contÚm arquivos de aula)
        aulas_item = None
        for item in self.nav:
            name = list(item.keys())[0]
            if "Aula" in name or "LiþÒo" in name:
                aulas_item = item
                break
    
        if not aulas_item:
            # Fallback to the second item if names don't match
            if len(self.nav) > 1:
                aulas_item = self.nav[1]
            else:
                pytest.skip("Aulas section not found in nav")
    
        aulas_section_name = list(aulas_item.keys())[0]
        aulas_list = aulas_item[aulas_section_name]
    
        # Encontrar primeiro m¾dulo (aninhamento) ou primeira aula direta
        first_lesson_info = None
        module_name = None
    
        for item in aulas_list:
            if isinstance(item, dict):
                m_name = list(item.keys())[0]
                m_content = item[m_name]
                if isinstance(m_content, list) and len(m_content) > 0:
                    module_name = m_name
                    first_lesson_info = m_content[0]
                    break
            elif isinstance(item, str):
                # Caso a primeira "aula" seja o index.md ou similar
                continue
    
        if not first_lesson_info:
            pytest.skip("No lessons found in Aulas section")
    
        lesson_name = list(first_lesson_info.keys())[0] if isinstance(first_lesson_info, dict) else str(first_lesson_info)
    
        # AþÒo: Clicar na seþÒo pai
        page.get_by_role("link", name=aulas_section_name).first.click(force=True)
    
        # AþÒo: Clicar no M¾dulo (se houver)
        if module_name:
            # Tenta clicar no texto do m¾dulo primeiro, o que Ú mais robusto que o label:has-text
>           page.get_by_text(module_name).first.click(force=True)

tests\test_navigation.py:100: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Python\Python313\Lib\site-packages\playwright\sync_api\_generated.py:15631: in click
    self._sync(
C:\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py:162: in click
    return await self._frame._click(self._selector, strict=True, **params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py:566: in _click
    await self._channel.send("click", self._timeout, locals_to_params(locals()))
C:\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py:69: in send
    return await self._connection.wrap_api_call(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <playwright._impl._connection.Connection object at 0x000001A5CE2D2660>
cb = <function Channel.send.<locals>.<lambda> at 0x000001A5CEE8B880>
is_internal = False, title = None

    async def wrap_api_call(
        self, cb: Callable[[], Any], is_internal: bool = False, title: str = None
    ) -> Any:
        if self._api_zone.get():
            return await cb()
        task = asyncio.current_task(self._loop)
        st: List[inspect.FrameInfo] = getattr(
            task, "__pw_stack__", None
        ) or inspect.stack(0)
    
        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal, title)
        self._api_zone.set(parsed_st)
        try:
            return await cb()
        except Exception as error:
>           raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
E           playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.
E           Call log:
E             - waiting for get_by_text("M¾dulo 1 - Fundamentos e Oportunidade").first

C:\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py:559: TimeoutError
=========================== short test summary info ===========================
FAILED tests/test_navigation.py::TestNavigation::test_navigation_to_first_lesson[chromium]
======================== 1 failed, 2 passed in 39.32s =========================
